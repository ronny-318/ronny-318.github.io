<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ADHD Focus Timer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style type="text/tailwindcss">
      @layer components {
        .step-dot {
          @apply w-12 h-12 rounded-full bg-white border-4 border-gray-200 flex items-center justify-center font-bold text-gray-400 z-10 transition-all duration-300 relative;
        }
        /* 집중 시간용 테두리 채우기 스타일 */
        .active-focus {
          @apply border-transparent text-red-500 scale-110 shadow-lg;
          background-image: conic-gradient(
            #ef4444 var(--progress, 0%),
            #f3f4f6 var(--progress, 0%)
          );
          background-origin: border-box;
          background-clip: content-box, border-box;
        }
        /* 원 안쪽 흰색 유지를 위한 가상 요소 */
        .active-focus::before {
          content: "";
          @apply absolute inset-1 bg-white rounded-full -z-10;
        }
        .completed-step {
          @apply bg-red-500 border-red-500 text-white shadow-md shadow-red-200;
        }
        @layer components {
          /* 물결 애니메이션 */
          .wave {
            @apply absolute top-[-15px] left-0 w-full h-10;
            background: url("https://cdn.jsdelivr.net/gh/front733/static/wave.svg"); /* 물결 SVG 패턴 */
            background-size: 50% 100%;
            animation: wave-move 3s linear infinite;
          }

          @keyframes wave-move {
            0% {
              transform: translateX(0);
            }
            100% {
              transform: translateX(50%);
            }
          }

          /* 집중/휴식 상태에 따른 물 색상 변경 */
          .bg-work {
            @apply bg-red-500/80;
          }
          .bg-rest {
            @apply bg-blue-500/80;
          }
        }
        .custom-scrollbar::-webkit-scrollbar {
          width: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          @apply bg-transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          @apply bg-gray-200 rounded-full hover:bg-gray-300;
        }
      }
    </style>
  </head>
  <body
    class="bg-gray-100 lg:h-screen flex flex-col lg:flex-row overflow-y-auto lg:overflow-hidden"
  >
    <nav
      class="w-full lg:w-64 bg-white border-b lg:border-r shrink-0 flex lg:flex-col items-center lg:items-stretch p-4 lg:p-6 sticky top-0 z-50"
    >
      <div class="text-xl font-bold text-red-500 lg:mb-8">Focus</div>

      <button
        class="lg:hidden p-2 text-gray-600 focus:outline-none ml-auto"
        onclick="toggleMenu()"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16m-7 6h7"
          />
        </svg>
      </button>

      <div
        id="nav-menu"
        class="hidden lg:flex flex-col space-y-2 w-full bg-white lg:bg-transparent p-4 lg:p-0 border-t lg:border-none"
      >
        <a
          href="#"
          class="block p-3 bg-red-50 text-red-600 rounded-lg font-medium"
          >dashboard</a
        >
        <a href="#" class="block p-3 text-gray-500 hover:bg-gray-50 rounded-lg"
          >community</a
        >
      </div>
    </nav>

    <main
      id="main-container"
      class="flex-1 p-4 lg:p-8 flex flex-col items-center justify-center min-h-[70vh]"
    >
      <div
        id="timer-card"
        class="bg-white p-8 lg:p-12 rounded-[3rem] shadow-xl text-center w-full max-w-md relative overflow-hidden"
      >
        <div
          class="relative w-64 h-64 mx-auto mb-8 rounded-full border-8 border-gray-100 shadow-inner overflow-hidden bg-gray-50"
        >
          <div
            id="water-level"
            class="absolute bottom-0 left-[-50%] w-[200%] h-0 bg-red-500/80 transition-all duration-1000 ease-linear"
          >
            <div class="wave"></div>
          </div>
          <div
            class="relative z-10 flex flex-col items-center justify-center h-full"
          >
            <h2
              id="status"
              class="text-sm font-bold text-gray-400 mb-1 uppercase tracking-widest"
            >
              Focusing
            </h2>
            <div
              id="timer"
              class="text-6xl font-black text-gray-800 tracking-tighter"
            >
              25:00
            </div>
            <div
              id="round-indicator"
              class="text-xs mt-2 font-bold text-red-500 bg-red-50 px-3 py-1 rounded-full"
            >
              Round 1/3
            </div>
          </div>
        </div>

        <button
          id="start-pause-btn"
          onclick="startTimer()"
          class="bg-red-500 hover:bg-red-600 text-white px-8 py-4 rounded-2xl font-black transition-all shadow-lg active:scale-95 whitespace-nowrap min-w-[140px]"
        >
          시작하기
        </button>

        <div
          id="task-area"
          class="mt-6 pt-6 border-t border-gray-100 transition-all"
        >
          <input
            type="text"
            id="task-input"
            placeholder="지금 무엇을 끝냈나요?"
            class="w-full p-4 rounded-2xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-red-400 text-sm mb-3 transition-all"
          />
          <button
            onclick="finishTaskEarly()"
            class="w-full bg-gray-800 text-white p-4 rounded-2xl font-bold hover:bg-black transition-all text-sm shadow-sm"
          >
            ✅ 기록하고 다음으로
          </button>
        </div>
      </div>
    </main>

    <aside
      class="w-full lg:w-80 bg-white border-t lg:border-l p-6 flex flex-col h-full shrink-0"
    >
      <div class="flex items-center justify-between mb-6 shrink-0">
        <div class="flex items-baseline space-x-2">
          <h3 class="text-lg font-bold">실행 로그</h3>
          <span
            id="log-count"
            class="text-sm font-medium text-red-500 bg-red-50 px-2 py-0.5 rounded-full"
            >0</span
          >
        </div>

        <select
          id="date-filter"
          onchange="renderLogs()"
          class="text-xs border-none bg-gray-100 rounded-lg px-2 py-1.5 focus:ring-2 focus:ring-red-400 outline-none cursor-pointer"
        >
          <option value="all">전체 날짜</option>
        </select>
      </div>

      <div class="flex-1 overflow-y-auto pr-2 custom-scrollbar">
        <ul id="log-list" class="space-y-4"></ul>
      </div>
    </aside>

    <div
      id="custom-modal"
      class="hidden fixed inset-0 bg-black/60 flex items-center justify-center z-[100] backdrop-blur-sm"
    >
      <div
        class="bg-white p-8 rounded-[2rem] shadow-2xl max-w-sm w-full mx-4 text-center transform transition-all"
      >
        <div class="text-5xl mb-4">☕</div>
        <h3 class="text-2xl font-bold mb-2 text-gray-800">기록 완료!</h3>
        <p id="modal-msg" class="text-gray-500 mb-8 leading-relaxed">
          정말 고생하셨어요!<br />지금 바로 휴식할까요?
        </p>

        <div class="flex space-x-3">
          <button
            id="modal-yes"
            class="flex-1 bg-blue-500 text-white py-4 rounded-2xl font-bold hover:bg-blue-600 transition-all shadow-md active:scale-95"
          >
            네, 쉴래요
          </button>
          <button
            id="modal-no"
            class="flex-1 bg-gray-100 text-gray-600 py-4 rounded-2xl font-bold hover:bg-gray-200 transition-all active:scale-95"
          >
            아니오
          </button>
        </div>
      </div>
    </div>

    <script>
      function toggleMenu() {
        const menu = document.getElementById("nav-menu");
        menu.classList.toggle("hidden");
      }
    </script>
    <script src="scripts/constants.js"></script>
    <script src="scripts/ui.js"></script>
    <script src="scripts/main.js"></script>
  </body>
</html>
